{"ast":null,"code":"import _regeneratorRuntime from\"/home/tyler/react-minesweeper/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/home/tyler/react-minesweeper/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _classCallCheck from\"/home/tyler/react-minesweeper/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/home/tyler/react-minesweeper/node_modules/@babel/runtime/helpers/esm/createClass\";import _inherits from\"/home/tyler/react-minesweeper/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"/home/tyler/react-minesweeper/node_modules/@babel/runtime/helpers/esm/createSuper\";import React from'react';import'./Minesweeper.css';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var Minesweeper=/*#__PURE__*/function(_React$Component){_inherits(Minesweeper,_React$Component);var _super=_createSuper(Minesweeper);/*\n    * Crete a new minesweeper component\n    */function Minesweeper(props){var _this;_classCallCheck(this,Minesweeper);_this=_super.call(this,props);// Read in props\n_this.state={size:props.size,mines:props.mines,numLeft:props.size*props.size-props.mines,status:\"playing\",map:[]};// Create a new mine field\n_this.createNewMap();return _this;}/*\n    * Inititalize a minesweeper map with this.state.size (square) ad this.state.mines\n    */_createClass(Minesweeper,[{key:\"createNewMap\",value:function createNewMap(){var _map=this.state.map;// Create the blank map\nfor(var x=0;x<this.state.size;x++){_map[x]=[];for(var y=0;y<this.state.size;y++){_map[x][y]={\"flag\":false,\"open\":false,\"mine\":false};}}// Randomize mine locations\nfor(var i=0;i<this.state.mines;i++){_map[Math.floor(Math.random()*this.state.size)][Math.floor(Math.random()*this.state.size)].mine=true;}// Store it\nthis.setState({map:_map});}/*\n    * Handles when a space gets left clicked\n    */},{key:\"leftClickHandler\",value:function(){var _leftClickHandler=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(x,y){var _this2=this;var _map,i,j;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:if(!(this.state.status!==\"playing\")){_context.next=2;break;}return _context.abrupt(\"return\");case 2:if(!(this.state.map[x][y].flag||this.state.map[x][y].open)){_context.next=4;break;}return _context.abrupt(\"return\");case 4:_map=this.state.map;_map[x][y].open=true;// Check if we won after updating the map.\n// Note that we need to do this syncronously in order to properly count down.\n_context.next=8;return new Promise(function(end){_this2.setState({map:_map,numLeft:_this2.state.numLeft-1},function(){if(_this2.state.map[x][y].mine){_this2.setState({status:\"lose\"});}else if(_this2.state.numLeft===0){_this2.setState({status:\"win\"});}end();});});case 8:// If we get a zero square, left click all around it for auto complete.\nif(this.countNeighborBombs(x,y)===0){for(i=x-1;i<=x+1;i++){for(j=y-1;j<=y+1;j++){if(i>=0&&j>=0&&i<this.state.size&&j<this.state.size){this.leftClickHandler(i,j);}}}}case 9:case\"end\":return _context.stop();}}},_callee,this);}));function leftClickHandler(_x,_x2){return _leftClickHandler.apply(this,arguments);}return leftClickHandler;}()/*\n    * Handles when a space gets right clicked\n    */},{key:\"rightClickHandler\",value:function rightClickHandler(e,x,y){if(this.state.status!==\"playing\")return;e.preventDefault();// Toggle the flag\nvar _map=this.state.map;_map[x][y].flag=!_map[x][y].flag;this.setState({map:_map});}/*\n    * Determines the bombs that surround this space\n    */},{key:\"countNeighborBombs\",value:function countNeighborBombs(x,y){var count=0;for(var i=x-1;i<=x+1;i++){for(var j=y-1;j<=y+1;j++){if(i>=0&&j>=0&&i<this.state.size&&j<this.state.size){if(this.state.map[i][j].mine){count++;}}}}return count;}/*\n    * Determines the text to put in this space\n    */},{key:\"determineSpaceContent\",value:function determineSpaceContent(x,y){if(this.state.map[x][y].open){if(this.state.map[x][y].mine){return\"X\";}else{var num=this.countNeighborBombs(x,y);return num>0?num.toString():\"\";}}else if(this.state.map[x][y].flag){return\"âœ”\";}else{return\"\";}}/*\n    * Win/lose message if needed\n    */},{key:\"determineMessage\",value:function determineMessage(){if(this.state.status===\"win\"){return\"You won!\";}else if(this.state.status===\"lose\"){return\"You hit a bomb!\";}else{return\"\";}}/*\n    * Render the component\n    */},{key:\"render\",value:function render(){var _this3=this;return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"table\",{className:\"gameboard\",children:[/*#__PURE__*/_jsx(\"thead\",{}),/*#__PURE__*/_jsx(\"tbody\",{children:Array.from(Array(this.state.size).keys()).map(function(y){return/*#__PURE__*/_jsx(\"tr\",{children:Array.from(Array(_this3.state.size).keys()).map(function(x){return/*#__PURE__*/_jsx(\"td\",{className:_this3.state.map[x][y].open?\"openCell\":\"closedCell\",onClick:function onClick(e){return _this3.leftClickHandler(x,y);},onContextMenu:function onContextMenu(e){return _this3.rightClickHandler(e,x,y);},children:_this3.determineSpaceContent(x,y)},x);})},y);})})]}),/*#__PURE__*/_jsx(\"center\",{children:/*#__PURE__*/_jsx(\"h1\",{children:this.determineMessage()})})]});}}]);return Minesweeper;}(React.Component);export default Minesweeper;","map":null,"metadata":{},"sourceType":"module"}